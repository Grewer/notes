<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>deps check</title>
</head>
<body>
<div style='width: 100vw;height: 100vh' id='main'></div>
<div id='list'></div>
<script type='module'>
    import data from './deepCheck.json' assert { type: 'json' }
    import './node_modules/echarts/dist/echarts.min.js'
    console.log(echarts)
    const {nodes, edges, topSizeIns} = data

    var chartDom = document.getElementById('main');
    var myChart = echarts.init(chartDom);
    var option;

    myChart.showLoading()

    myChart.hideLoading();
    myChart.setOption(
        (option = {
            title: {
                text: 'NPM Dependencies'
            },
            animationDurationUpdate: 1500,
            animationEasingUpdate: 'quinticInOut',
            series: [
                {
                    type: 'graph',
                    layout: 'none',
                    // progressiveThreshold: 700,
                    data: nodes,
                    edges: edges,
                    emphasis: {
                        focus: 'adjacency',
                        label: {
                            show: true
                        }
                    },
                    roam: true,
                    lineStyle: {
                        width: 0.5,
                        curveness: 0.3,
                        opacity: 0.7
                    }
                }
            ]
        }))

    console.log(option)
    option && myChart.setOption(option);

    const list = document.getElementById('list')
    topSizeIns.arr.forEach(item=>{
        const box = document.createElement('p')
        const common = item.items.find(it=>it.label === 'common')
        box.textContent = `${common.location}--${item.size.toFixed(2)}KB`
        list.appendChild(box)

        const fragment = document.createElement('ul')

        fragment.innerHTML = item.items.map(it=>{
            return `<li>${it.location}@${it.version}--size:${it.size}</li>`
        }).join('')

        list.appendChild(fragment)
    })

</script>
</body>
</html>