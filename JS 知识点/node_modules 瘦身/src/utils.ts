import fs from "fs";

export function getFileSize(path) {
    const size = readFile(path, 0) // b
    return (size / 1024).toFixed(2) // 单位 kb
}

//遍历读取文件
function readFile(path, size) {
    let files = fs.readdirSync(path)
    files.forEach(walk)

    function walk(file) {
        let states = fs.statSync(path + '/' + file)
        if (states.isDirectory()) {
            readFile(path + '/' + file, size)
        } else {
            size += states.size
        }
    }

    return size
}


export const createTopSize = ()=>{
    let arr = []
    const push = (item) => {
        if(!arr.length){
            arr.push(item)
            return
        }
        for(let i =0,len=arr.length;i<len;i++){
            if(item.size >= arr[i].size){
                arr.splice(i, 0, item)
                break;
            }
        }
        if(arr.length === 6){
            arr.pop()
        }
    }

    return {
        length: arr.length,
        push: push,
        arr: arr,
    }
}